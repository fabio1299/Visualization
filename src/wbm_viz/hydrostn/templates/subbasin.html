{% extends "base.html" %}

    {% block title %} Subbasin {{ subbasin.id }} {% endblock %}

    {% load leaflet_tags %}
    {% leaflet_js %}
    {% leaflet_css %}

    {% block style %}
    <style>
        .map {
            {#width: 1000px;#}
            {#height: 1000px;#}
        }
    </style>
    {% endblock %}

    {% block script %}
    <script type="text/javascript">
        const argentina_coords = [-38.4161, -63.6167]

        function catchment_style(feature){
            return {
                color : '#00FFFF',
                opacity : 0.8,
                fillColor: '#33BBFF',
                fillOpacity: 0.2
            }
        }

        function subbasin_style(feature){
            return{
                color : 'red',
                opacity : 0.8,
                fillColor: '#3333FF',
                fillOpacity: 0.5
            }
        }

        function subbasin_map_init(map, options) {
            {#map.setView(argentina_coords, 3);#}

            const subbasin_polygon = L.geoJSON({{ subbasin.geom.geojson|safe }},{style: subbasin_style})
            const subbasin_catchment = L.geoJSON({{ subbasin.get_catchment|safe }},{style: catchment_style})

            subbasin_catchment.addTo(map)
            subbasin_polygon.addTo(map)
            map.fitWorld()
            map.fitBounds(subbasin_catchment.getBounds())
        }

    </script>
{% endblock %}
</head>

{% block content %}

    <h2>Subbasin</h2>
    <div class="map" id="subbasin_map">
        {% leaflet_map "subbasin_map" callback="subbasin_map_init" %}
    </div>

    <p>Subbasin Stream Order: {{ subbasin.stream_order }}</p>
    <p>Subbasin Perimeter: {{ subbasin.perimeter }}</p>
    <p>Subbasin Area: {{ subbasin.grid_area }}</p>
    <p>Subbasin Catchment Area: {{ subbasin.stn_catchment_area }}</p>
    <p></p>

{% endblock %}

